Content-type: text/html; charset=utf-8
X-Powered-By: Rust/1.19.0
Content-Language: en

<!DOCTYPE html>
<html>
<head>
	<title>Amanda's homepage - {title}</title>
	<meta name="author" content="Amanda Graven">
	<meta name="description" content="Personal homepage of Amanda Graven">

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="/style.css">
	<script src='https://www.google.com/recaptcha/api.js?render=explicit&onload=captchaLoad' async defer></script>
	<script>
		var captchaLoad = function() {lbrace}
			grecaptcha.render(
				'root-captcha',
				{lbrace} 'sitekey' : '6Lcs3ywUAAAAAN7ASI4sa9wr8ujsfoZd0xgnpnWV' {rbrace}
			);
		{rbrace}
		function show(element) {lbrace}
			element.style.display = "block";
			grecaptcha.render(
				element.getElementsByClassName("g-recaptcha")[0],
				{lbrace} 'sitekey' : '6Lcs3ywUAAAAAN7ASI4sa9wr8ujsfoZd0xgnpnWV' {rbrace}
			);
		{rbrace}
		function hide(element) {lbrace}
			element.style.display = "none";
		{rbrace}
		function send(form) {lbrace}
			function urlencodeFormData(fd) {lbrace}
				var s = '';
				function encode(s){lbrace}
					return encodeURIComponent(s).replace(/%20/g,'+');
				{rbrace}
				for(var pair of fd.entries()) {lbrace}
					if(typeof pair[1]=='string') {lbrace}
						s += (s?'&':'') + encode(pair[0])+'='+encode(pair[1]);
					{rbrace}
				{rbrace}
				return s;
			{rbrace}
			var data = new FormData(form);
			data.set("post", {post});
			for (var key of data.keys()) {lbrace}
				console.log('Key: ' + key);
			{rbrace}

			var request = new XMLHttpRequest();
			request.open("POST", "/comment.cgi", true);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			request.onreadystatechange = function() {lbrace}
				if (this.readyState == 4 && this.status == 200) {lbrace}
					form.parentElement.innerHTML += this.responseText;
				{rbrace}
			{rbrace}
			request.send(urlencodeFormData(data));
		{rbrace}
	</script>
</head>
<body>
	<div id="headbar">
		<div id="headbar-content">
			<div class="title" style="float: left;">Amanda's terrible homepage</div>
			<ul class="navbar">
				<li><a href="/">Home</a></li>
				<li><a href="/about">About</a></li>
			</ul>
		</div>
	</div>
	<div id="easter-egg"> </div>
	<main>
		<div id="body-title">
			<div class="title">Amanda's terrible homepage</div>
		</div>
		{article}
		<article>
			<form action="/comment.cgi" id="reply-root" method="post" onsubmit="send(this); return false;">
				<input name="parent" value="-1" style="display: none;">
				Name: <input type="text" name="name" required><br>
				<textarea name="content" required></textarea><br>
				<div
					id="root-captcha"
					class="g-recaptcha"
	 				data-sitekey="6Lcs3ywUAAAAAN7ASI4sa9wr8ujsfoZd0xgnpnWV"></div>
				<button type="submit">Submit</button>
			</form>
		</article>
		{comments}
	</main>
</body>
</html>
